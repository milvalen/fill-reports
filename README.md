# **Инструкция по использованию шаблона генерации документов**

## Описание

Этот проект предназначен для автоматической генерации документов на основе шаблона в формате `.docx`. Скрипт заполняет шаблон данными из файла `.ods`, заменяя соответствующие плейсхолдеры в документе.

## Структура проекта

- **blank.ods**: Таблица с данными, которые будут подставлены в шаблон.
- **Balvanka.docx**: Шаблон документа с плейсхолдерами.
- **filled/**: Папка, куда будут сохраняться готовые документы.
- **main.py**: Основной Python-скрипт, выполняющий заполнение шаблона.
- **.venv/**: Виртуальная среда с установленными зависимостями (Python и библиотеки).
- **start.bat**: Скрипт для запуска на Windows.
- **start.sh**: Скрипт для запуска на macOS и Linux.

## Требования

- **ОС**: Windows, macOS, или Linux.
- **Python**: Локально установленный Python не требуется, так как проект использует виртуальную среду (`.venv`), которая уже содержит все необходимые библиотеки.

## Установка

1. **Клонирование репозитория**:
   - Скачайте или клонируйте проект на ваш компьютер.

2. **Убедитесь, что структура проекта выглядит следующим образом**:
   ```
   fill-reports/
   ├── blank.ods
   ├── Balvanka.docx
   ├── main.py
   ├── filled/
   ├── .venv/
   ├── start.bat
   └── start.sh
   ```

## Использование

### 1. **Windows**

- Дважды щелкните на файл `start.bat`.
- Скрипт автоматически активирует виртуальную среду, выполнит заполнение шаблона, и сохранит готовый документ в папке `filled`.
- В конце работы скрипта откроется окно с сообщением о сохранении документа.

### 2. **macOS и Linux**

- Откройте терминал и перейдите в директорию с проектом.
- Сделайте файл `start.sh` исполняемым, если это еще не сделано:
  ```bash
  chmod +x run_template_filler.sh
  ```
- Запустите скрипт командой:
  ```bash
  ./start.sh
  ```
- Скрипт активирует виртуальную среду, выполнит заполнение шаблона, и сохранит готовый документ в папке `filled`.

## Подготовка данных

- Откройте файл `blank.ods` и заполните его данными. Каждая строка должна содержать два столбца:
  - **Первый столбец**: Имя плейсхолдера (например, `Номер договора`, `Дата договора`).
  - **Второй столбец**: Значение, которое нужно подставить на место плейсхолдера.

## Плейсхолдеры в шаблоне

В документе `Balvanka.docx` используйте следующие плейсхолдеры для подстановки значений:
- Плейсхолдеры оформляются в виде `<<<ИМЯ ПЛЕЙСХОЛДЕРА>>>` (например, `<<<Номер договора>>>`, `<<<Дата договора>>>`).
- Специальный плейсхолдер `<<<ДС>>>` будет заменен на несколько строк в формате `ДС № *Номер договора*/N`, где `N` — порядковый номер. Количество строк равняется числу в колонке `ДС`.

## Результат

- После успешного выполнения скрипта, готовый документ будет сохранен в папке `filled` под именем:
  ```
  ЭЗ *Номер договора*.docx
  ```
